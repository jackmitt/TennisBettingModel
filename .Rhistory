library(dplyr)
library(tidyr)
library(ggplot2)
data = read.csv("C:/Users/JackMitt/Documents/TennisBettingModel/csv_data/predictions.csv")
KellyDiv = 1
View(data)
library(dplyr)
library(tidyr)
library(ggplot2)
data = read.csv("C:/Users/JackMitt/Documents/TennisBettingModel/csv_data/predictions.csv")
KellyDiv = 1
ah = data %>% select(Player.1.Win, Player.1.Prob) %>% drop_na() %>% arrange(Player.1.Prob)
index = seq(1, nrow(ah))
l = index[0+1:trunc(nrow(ah)/2)]
ll = l[0+1:trunc(length(l)/2)]
six = l[(trunc(length(l)/2)+1):trunc(length(l))]
lll = ll[0+1:trunc(length(ll)/2)]
five = ll[(trunc(length(ll)/2)+1):trunc(length(ll))]
llll = lll[0+1:trunc(length(lll)/2)]
four = lll[(trunc(length(lll)/2)+1):trunc(length(lll))]
lllll = llll[0+1:trunc(length(llll)/2)]
three = llll[(trunc(length(llll)/2)+1):trunc(length(llll))]
llllll = lllll[0+1:trunc(length(lllll)/2)]
two = lllll[(trunc(length(lllll)/2)+1):trunc(length(lllll))]
one = lllll[0+1:trunc(length(lllll)/2)]
r = index[(trunc(nrow(ah)/2)+1):nrow(ah)]
rr = r[(trunc(length(r)/2)+1):length(r)]
seven = r[0+1:trunc(length(r)/2)]
rrr = rr[(trunc(length(rr)/2)+1):length(rr)]
eight = rr[0+1:trunc(length(rr)/2)]
rrrr = rrr[(trunc(length(rrr)/2)+1):length(rrr)]
nine = rrr[0+1:trunc(length(rrr)/2)]
rrrrr = rrrr[(trunc(length(rrrr)/2)+1):length(rrrr)]
ten = rrrr[0+1:trunc(length(rrrr)/2)]
rrrrrr = rrrrr[(trunc(length(rrrrr)/2)+1):length(rrrrr)]
eleven = rrrrr[0+1:trunc(length(rrrrr)/2)]
twelve = rrrrr[(trunc(length(rrrrr)/2)+1):trunc(length(rrrrr))]
predictedRate = c(mean(ah$Spread.PFITS[one]),mean(ah$Spread.PFITS[two]),mean(ah$Spread.PFITS[three]),mean(ah$Spread.PFITS[four]),mean(ah$Spread.PFITS[five]),mean(ah$Spread.PFITS[six]),mean(ah$Spread.PFITS[seven]),mean(ah$Spread.PFITS[eight]),mean(ah$Spread.PFITS[nine]),mean(ah$Spread.PFITS[ten]),mean(ah$Spread.PFITS[eleven]),mean(ah$Spread.PFITS[twelve]))
actualRate = c(mean(ah$binSpread[one]),mean(ah$binSpread[two]),mean(ah$binSpread[three]),mean(ah$binSpread[four]),mean(ah$binSpread[five]),mean(ah$binSpread[six]),mean(ah$binSpread[seven]),mean(ah$binSpread[eight]),mean(ah$binSpread[nine]),mean(ah$binSpread[ten]),mean(ah$binSpread[eleven]),mean(ah$binSpread[twelve]))
n = c(length(ah$binSpread[one]),length(ah$binSpread[two]),length(ah$binSpread[three]),length(ah$binSpread[four]),length(ah$binSpread[five]),length(ah$binSpread[six]),length(ah$binSpread[seven]),length(ah$binSpread[eight]),length(ah$binSpread[nine]),length(ah$binSpread[ten]),length(ah$binSpread[eleven]),length(ah$binSpread[twelve]))
ahdf = data.frame(predictedRate,actualRate,n)
ggplot(ahdf, aes(y=actualRate, x=predictedRate, color = n, size = n)) + geom_point() + geom_abline(slope=1, intercept=0) + xlim(0,1) + ylim(0,1)
library(dplyr)
library(tidyr)
library(ggplot2)
data = read.csv("C:/Users/JackMitt/Documents/TennisBettingModel/csv_data/predictions.csv")
KellyDiv = 1
ah = data %>% select(Player.1.Win, Player.1.Prob) %>% drop_na() %>% arrange(Player.1.Prob)
index = seq(1, nrow(ah))
l = index[0+1:trunc(nrow(ah)/2)]
ll = l[0+1:trunc(length(l)/2)]
six = l[(trunc(length(l)/2)+1):trunc(length(l))]
lll = ll[0+1:trunc(length(ll)/2)]
five = ll[(trunc(length(ll)/2)+1):trunc(length(ll))]
llll = lll[0+1:trunc(length(lll)/2)]
four = lll[(trunc(length(lll)/2)+1):trunc(length(lll))]
lllll = llll[0+1:trunc(length(llll)/2)]
three = llll[(trunc(length(llll)/2)+1):trunc(length(llll))]
llllll = lllll[0+1:trunc(length(lllll)/2)]
two = lllll[(trunc(length(lllll)/2)+1):trunc(length(lllll))]
one = lllll[0+1:trunc(length(lllll)/2)]
r = index[(trunc(nrow(ah)/2)+1):nrow(ah)]
rr = r[(trunc(length(r)/2)+1):length(r)]
seven = r[0+1:trunc(length(r)/2)]
rrr = rr[(trunc(length(rr)/2)+1):length(rr)]
eight = rr[0+1:trunc(length(rr)/2)]
rrrr = rrr[(trunc(length(rrr)/2)+1):length(rrr)]
nine = rrr[0+1:trunc(length(rrr)/2)]
rrrrr = rrrr[(trunc(length(rrrr)/2)+1):length(rrrr)]
ten = rrrr[0+1:trunc(length(rrrr)/2)]
rrrrrr = rrrrr[(trunc(length(rrrrr)/2)+1):length(rrrrr)]
eleven = rrrrr[0+1:trunc(length(rrrrr)/2)]
twelve = rrrrr[(trunc(length(rrrrr)/2)+1):trunc(length(rrrrr))]
predictedRate = c(mean(ah$Player.1.Prob[one]),mean(ah$Player.1.Prob[two]),mean(ah$Player.1.Prob[three]),mean(ah$Player.1.Prob[four]),mean(ah$Player.1.Prob[five]),mean(ah$Player.1.Prob[six]),mean(ah$Player.1.Prob[seven]),mean(ah$Player.1.Prob[eight]),mean(ah$Player.1.Prob[nine]),mean(ah$Player.1.Prob[ten]),mean(ah$Player.1.Prob[eleven]),mean(ah$Player.1.Prob[twelve]))
actualRate = c(mean(ah$Player.1.Win[one]),mean(ah$Player.1.Win[two]),mean(ah$Player.1.Win[three]),mean(ah$Player.1.Win[four]),mean(ah$Player.1.Win[five]),mean(ah$Player.1.Win[six]),mean(ah$Player.1.Win[seven]),mean(ah$Player.1.Win[eight]),mean(ah$Player.1.Win[nine]),mean(ah$Player.1.Win[ten]),mean(ah$Player.1.Win[eleven]),mean(ah$Player.1.Win[twelve]))
n = c(length(ah$Player.1.Win[one]),length(ah$Player.1.Win[two]),length(ah$Player.1.Win[three]),length(ah$Player.1.Win[four]),length(ah$Player.1.Win[five]),length(ah$Player.1.Win[six]),length(ah$Player.1.Win[seven]),length(ah$Player.1.Win[eight]),length(ah$Player.1.Win[nine]),length(ah$Player.1.Win[ten]),length(ah$Player.1.Win[eleven]),length(ah$Player.1.Win[twelve]))
ahdf = data.frame(predictedRate,actualRate,n)
ggplot(ahdf, aes(y=actualRate, x=predictedRate, color = n, size = n)) + geom_point() + geom_abline(slope=1, intercept=0) + xlim(0,1) + ylim(0,1)
ggplot(ahdf, aes(y=actualRate, x=predictedRate, color = n, size = n)) + geom_point() + geom_abline(slope=1, intercept=0) + xlim(0.25,0.75) + ylim(0.25,0.75)
library(dplyr)
library(tidyr)
library(ggplot2)
data = read.csv("C:/Users/JackMitt/Documents/TennisBettingModel/csv_data/predictions.csv")
KellyDiv = 1
ah = data %>% select(Player.1.Win, Book.Prob) %>% drop_na() %>% arrange(Book.Prob)
index = seq(1, nrow(ah))
l = index[0+1:trunc(nrow(ah)/2)]
ll = l[0+1:trunc(length(l)/2)]
six = l[(trunc(length(l)/2)+1):trunc(length(l))]
lll = ll[0+1:trunc(length(ll)/2)]
five = ll[(trunc(length(ll)/2)+1):trunc(length(ll))]
llll = lll[0+1:trunc(length(lll)/2)]
four = lll[(trunc(length(lll)/2)+1):trunc(length(lll))]
lllll = llll[0+1:trunc(length(llll)/2)]
three = llll[(trunc(length(llll)/2)+1):trunc(length(llll))]
llllll = lllll[0+1:trunc(length(lllll)/2)]
two = lllll[(trunc(length(lllll)/2)+1):trunc(length(lllll))]
one = lllll[0+1:trunc(length(lllll)/2)]
r = index[(trunc(nrow(ah)/2)+1):nrow(ah)]
rr = r[(trunc(length(r)/2)+1):length(r)]
seven = r[0+1:trunc(length(r)/2)]
rrr = rr[(trunc(length(rr)/2)+1):length(rr)]
eight = rr[0+1:trunc(length(rr)/2)]
rrrr = rrr[(trunc(length(rrr)/2)+1):length(rrr)]
nine = rrr[0+1:trunc(length(rrr)/2)]
rrrrr = rrrr[(trunc(length(rrrr)/2)+1):length(rrrr)]
ten = rrrr[0+1:trunc(length(rrrr)/2)]
rrrrrr = rrrrr[(trunc(length(rrrrr)/2)+1):length(rrrrr)]
eleven = rrrrr[0+1:trunc(length(rrrrr)/2)]
twelve = rrrrr[(trunc(length(rrrrr)/2)+1):trunc(length(rrrrr))]
predictedRate = c(mean(ah$Book.Prob[one]),mean(ah$Book.Prob[two]),mean(ah$Book.Prob[three]),mean(ah$Book.Prob[four]),mean(ah$Book.Prob[five]),mean(ah$Book.Prob[six]),mean(ah$Book.Prob[seven]),mean(ah$Book.Prob[eight]),mean(ah$Book.Prob[nine]),mean(ah$Book.Prob[ten]),mean(ah$Book.Prob[eleven]),mean(ah$Book.Prob[twelve]))
actualRate = c(mean(ah$Player.1.Win[one]),mean(ah$Player.1.Win[two]),mean(ah$Player.1.Win[three]),mean(ah$Player.1.Win[four]),mean(ah$Player.1.Win[five]),mean(ah$Player.1.Win[six]),mean(ah$Player.1.Win[seven]),mean(ah$Player.1.Win[eight]),mean(ah$Player.1.Win[nine]),mean(ah$Player.1.Win[ten]),mean(ah$Player.1.Win[eleven]),mean(ah$Player.1.Win[twelve]))
n = c(length(ah$Player.1.Win[one]),length(ah$Player.1.Win[two]),length(ah$Player.1.Win[three]),length(ah$Player.1.Win[four]),length(ah$Player.1.Win[five]),length(ah$Player.1.Win[six]),length(ah$Player.1.Win[seven]),length(ah$Player.1.Win[eight]),length(ah$Player.1.Win[nine]),length(ah$Player.1.Win[ten]),length(ah$Player.1.Win[eleven]),length(ah$Player.1.Win[twelve]))
ahdf = data.frame(predictedRate,actualRate,n)
ggplot(ahdf, aes(y=actualRate, x=predictedRate, color = n, size = n)) + geom_point() + geom_abline(slope=1, intercept=0) + xlim(0.25,0.75) + ylim(0.25,0.75)
ggplot(ahdf, aes(y=actualRate, x=predictedRate, color = n, size = n)) + geom_point() + geom_abline(slope=1, intercept=0) + xlim(0,1) + ylim(0,1)
ah = data %>% select(Player.1.Win, Book.Prob) %>% drop_na() %>% arrange(Book.Prob)
View(ah)
data = read.csv("C:/Users/JackMitt/Documents/TennisBettingModel/csv_data/predictions.csv")
View(data)
ah = data %>% select(Player.1.Win, Book.Prob) %>% drop_na() %>% arrange(Book.Prob)
index = seq(1, nrow(ah))
l = index[0+1:trunc(nrow(ah)/2)]
ll = l[0+1:trunc(length(l)/2)]
six = l[(trunc(length(l)/2)+1):trunc(length(l))]
lll = ll[0+1:trunc(length(ll)/2)]
five = ll[(trunc(length(ll)/2)+1):trunc(length(ll))]
llll = lll[0+1:trunc(length(lll)/2)]
four = lll[(trunc(length(lll)/2)+1):trunc(length(lll))]
lllll = llll[0+1:trunc(length(llll)/2)]
three = llll[(trunc(length(llll)/2)+1):trunc(length(llll))]
llllll = lllll[0+1:trunc(length(lllll)/2)]
two = lllll[(trunc(length(lllll)/2)+1):trunc(length(lllll))]
one = lllll[0+1:trunc(length(lllll)/2)]
r = index[(trunc(nrow(ah)/2)+1):nrow(ah)]
rr = r[(trunc(length(r)/2)+1):length(r)]
seven = r[0+1:trunc(length(r)/2)]
rrr = rr[(trunc(length(rr)/2)+1):length(rr)]
eight = rr[0+1:trunc(length(rr)/2)]
rrrr = rrr[(trunc(length(rrr)/2)+1):length(rrr)]
nine = rrr[0+1:trunc(length(rrr)/2)]
rrrrr = rrrr[(trunc(length(rrrr)/2)+1):length(rrrr)]
ten = rrrr[0+1:trunc(length(rrrr)/2)]
rrrrrr = rrrrr[(trunc(length(rrrrr)/2)+1):length(rrrrr)]
eleven = rrrrr[0+1:trunc(length(rrrrr)/2)]
twelve = rrrrr[(trunc(length(rrrrr)/2)+1):trunc(length(rrrrr))]
predictedRate = c(mean(ah$Book.Prob[one]),mean(ah$Book.Prob[two]),mean(ah$Book.Prob[three]),mean(ah$Book.Prob[four]),mean(ah$Book.Prob[five]),mean(ah$Book.Prob[six]),mean(ah$Book.Prob[seven]),mean(ah$Book.Prob[eight]),mean(ah$Book.Prob[nine]),mean(ah$Book.Prob[ten]),mean(ah$Book.Prob[eleven]),mean(ah$Book.Prob[twelve]))
actualRate = c(mean(ah$Player.1.Win[one]),mean(ah$Player.1.Win[two]),mean(ah$Player.1.Win[three]),mean(ah$Player.1.Win[four]),mean(ah$Player.1.Win[five]),mean(ah$Player.1.Win[six]),mean(ah$Player.1.Win[seven]),mean(ah$Player.1.Win[eight]),mean(ah$Player.1.Win[nine]),mean(ah$Player.1.Win[ten]),mean(ah$Player.1.Win[eleven]),mean(ah$Player.1.Win[twelve]))
n = c(length(ah$Player.1.Win[one]),length(ah$Player.1.Win[two]),length(ah$Player.1.Win[three]),length(ah$Player.1.Win[four]),length(ah$Player.1.Win[five]),length(ah$Player.1.Win[six]),length(ah$Player.1.Win[seven]),length(ah$Player.1.Win[eight]),length(ah$Player.1.Win[nine]),length(ah$Player.1.Win[ten]),length(ah$Player.1.Win[eleven]),length(ah$Player.1.Win[twelve]))
ahdf = data.frame(predictedRate,actualRate,n)
ggplot(ahdf, aes(y=actualRate, x=predictedRate, color = n, size = n)) + geom_point() + geom_abline(slope=1, intercept=0) + xlim(0,1) + ylim(0,1)
warnings()
View(ah)
ah = data %>% select(Player.1.Win, Book.Prob)
View(ah)
index = seq(1, nrow(ah))
l = index[0+1:trunc(nrow(ah)/2)]
ll = l[0+1:trunc(length(l)/2)]
six = l[(trunc(length(l)/2)+1):trunc(length(l))]
lll = ll[0+1:trunc(length(ll)/2)]
five = ll[(trunc(length(ll)/2)+1):trunc(length(ll))]
llll = lll[0+1:trunc(length(lll)/2)]
four = lll[(trunc(length(lll)/2)+1):trunc(length(lll))]
lllll = llll[0+1:trunc(length(llll)/2)]
three = llll[(trunc(length(llll)/2)+1):trunc(length(llll))]
llllll = lllll[0+1:trunc(length(lllll)/2)]
two = lllll[(trunc(length(lllll)/2)+1):trunc(length(lllll))]
one = lllll[0+1:trunc(length(lllll)/2)]
r = index[(trunc(nrow(ah)/2)+1):nrow(ah)]
rr = r[(trunc(length(r)/2)+1):length(r)]
seven = r[0+1:trunc(length(r)/2)]
rrr = rr[(trunc(length(rr)/2)+1):length(rr)]
eight = rr[0+1:trunc(length(rr)/2)]
rrrr = rrr[(trunc(length(rrr)/2)+1):length(rrr)]
nine = rrr[0+1:trunc(length(rrr)/2)]
rrrrr = rrrr[(trunc(length(rrrr)/2)+1):length(rrrr)]
ten = rrrr[0+1:trunc(length(rrrr)/2)]
rrrrrr = rrrrr[(trunc(length(rrrrr)/2)+1):length(rrrrr)]
eleven = rrrrr[0+1:trunc(length(rrrrr)/2)]
twelve = rrrrr[(trunc(length(rrrrr)/2)+1):trunc(length(rrrrr))]
predictedRate = c(mean(ah$Book.Prob[one]),mean(ah$Book.Prob[two]),mean(ah$Book.Prob[three]),mean(ah$Book.Prob[four]),mean(ah$Book.Prob[five]),mean(ah$Book.Prob[six]),mean(ah$Book.Prob[seven]),mean(ah$Book.Prob[eight]),mean(ah$Book.Prob[nine]),mean(ah$Book.Prob[ten]),mean(ah$Book.Prob[eleven]),mean(ah$Book.Prob[twelve]))
actualRate = c(mean(ah$Player.1.Win[one]),mean(ah$Player.1.Win[two]),mean(ah$Player.1.Win[three]),mean(ah$Player.1.Win[four]),mean(ah$Player.1.Win[five]),mean(ah$Player.1.Win[six]),mean(ah$Player.1.Win[seven]),mean(ah$Player.1.Win[eight]),mean(ah$Player.1.Win[nine]),mean(ah$Player.1.Win[ten]),mean(ah$Player.1.Win[eleven]),mean(ah$Player.1.Win[twelve]))
n = c(length(ah$Player.1.Win[one]),length(ah$Player.1.Win[two]),length(ah$Player.1.Win[three]),length(ah$Player.1.Win[four]),length(ah$Player.1.Win[five]),length(ah$Player.1.Win[six]),length(ah$Player.1.Win[seven]),length(ah$Player.1.Win[eight]),length(ah$Player.1.Win[nine]),length(ah$Player.1.Win[ten]),length(ah$Player.1.Win[eleven]),length(ah$Player.1.Win[twelve]))
ahdf = data.frame(predictedRate,actualRate,n)
ggplot(ahdf, aes(y=actualRate, x=predictedRate, color = n, size = n)) + geom_point() + geom_abline(slope=1, intercept=0) + xlim(0,1) + ylim(0,1)
View(ah)
predictedRate = c(mean(ah$Book.Prob[one]),mean(ah$Book.Prob[two]),mean(ah$Book.Prob[three]),mean(ah$Book.Prob[four]),mean(ah$Book.Prob[five]),mean(ah$Book.Prob[six]),mean(ah$Book.Prob[seven]),mean(ah$Book.Prob[eight]),mean(ah$Book.Prob[nine]),mean(ah$Book.Prob[ten]),mean(ah$Book.Prob[eleven]),mean(ah$Book.Prob[twelve]))
ah$Book.Prob
ah$Book.Prob[one]
ah = data %>% select(Player.1.Win, Book.Prob) %>% drop_na() %>% arrange(Book.Prob)
View(ah)
